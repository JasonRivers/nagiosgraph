$Id$
------------------             License: OSI Artistic License
nagiosgraph README             Author:  (c) 2005 Soren Dossing
------------------             Author:  (c) 2008 Alan Brenner, Ithaka Harbors
                               Author:  (c) 2010 Matthew Wall

Nagiosgraph is an add-on of Nagios. It collects service performance data into
rrd format, and displays the resulting graphs via cgi.  It can be embedded
directly into Nagios so that graphs show up just like other trend reports.

The INSTALL file contains installation and configuration instructions.

Note: Nagios is a registered trademark of Ethan Galstad.


Getting Help
------------

Visit the help forum -- http://sourceforge.net/forum/forum.php?forum_id=394748
See also the project wiki -- http://nagiosgraph.wiki.sourceforge.net


Principles of Operations
------------------------

nagiosgraph is basically a simple interface between Nagios and rrd data
files. Simplicity comes from three factors; it doesn't do much, behavior
is programmed rather than configurable, and automatically detects new
data from Nagios.

nagiosgraphs is operating in two modes. One is to collect performance
data from servicechecks from nagios, and the other is to display graphs
of the performance data collected.

All the data collected are stored in rrd files by using rrdtools. A file
called 'map' defines how identify the data from nagios and how to store
it in the rrd files. Nagios passes all the service data collected to a
nagiosgraph script called 'insert.pl'. This script will look up in
'map', which rrd file to insert the data into, and how to name the data.

In Nagios, it's possible to have extended service information pages.
A nagiosgraph cgi script called 'show.cgi' is used for such service
information links. 'show.cgi' looks up performance data stored in rrd file
directories, and generates line charts accordingly.

nagiosgraph automatically detects new hosts or services added in Nagios,
so generally no re-configuration of nagiosgraph is necessary.

The 'map' configuration file is actually perl code, that will be eval'ed
by 'insert.pl' and 'show.cgi'. Several examples of servicechecks are
included in the distributed 'map' file, but generally it's necessary to
make modifications or add entries to match the output of the particular
nagios plugins in use. Knowing perl regular expression is helpful,
but the examples supplied should cover most types of performance data.

By default all available data for a servicecheck will be displayed in
the same graph. With extra configuration, embedded in the url, it's
possible to display less data or to split values into multiple graphs.
There is also a general method for specifying any rrd graph options.


Files
------

CHANGELOG             - History of changes
INSTALL               - How to install and use nagiosgraph
README                - This file
README.map            - Instructions to create map file entries.
TODO                  - A list of potential improvements to Nagiosgraph.
install.pl            - An initial stab at an installer (for the brave only).
lib/insert.pl         - Reads nagios perfdata log and insert into rrd files.
lib/insert.sh         - A shell script wrapper around insert.pl.
cgi/show.cgi          - Generates an html page for the host/service specified.
cgi/showgraph.cgi     - Generates graphs for show, showhost and showservices.
cgi/showhost.cgi      - Generates an html page for the host specified, showing
                          all available services on the host.
cgi/showservices.cgi  - Generates an html page for the service specified,
                          showing all hosts with that service.
cgi/testcolor.cgi     - Preview of colors for keywords in each color scheme
etc/nagiosgraph.conf  - paths and other configuration
etc/hostdb.conf       - Configuration specific to showhost.cgi
etc/servdb.conf       - Configuration specific to showservices.cgi
etc/rrdopts.conf      - Per-service options to rrdgraph
etc/map               - Regular expression to identify services and
                          specification for how to create rrd files.
etc/ngshared.pm       - Shared library of common perl subroutines
examples/*            - Configuration examples.
share/action.gif      - An icon for use in Nagios.
share/nagiosgraph.css - CSS stylesheet
share/nagiosgraph.js  - JavaScript
t/*                   - perl test scripts
utils/testentry.pl    - A script for testing new map file entries.
utils/upgrade.pl      - A script for upgrading from older releases.


For Developers
--------------

If you would like to contribute to Nagiosgraph, there are a few things you
should do to make your life and the lives of the other Nagiosgraph developers
easier.

- perlcritic

  Run perlcritic before you commit and fix all of the warnings.  Be brutal:

     perlcritic -1 etc/ngshared.pm
     perlcritic -1 cgi/show.cgi

  or use the make rule to run them all:

     perl Makefile.PL
     make critic

- unit tests

  Run the unit tests before modifying existing functionality.  Write unit
  tests before you start adding to the code.

      perl Makefile.PL
      make test

- configurations

  Be consistent in configuration files and documentation about where the
  nagiosgraph files are installed.  Use this layout:

 FIXME: which layout should we use?  debian?  ubuntu?  /opt?  /usr/local?

      /etc/nagiosgraph/nagiosgraph.conf
      /etc/nagiosgraph/ngshared.pm
      ??? /show.cgi
      ??? /nagiosgraph.css
      ??? /nagiosgraph.js
      /var/nagiosgraph/rrd/
